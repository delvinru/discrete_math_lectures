\section{Эквивалентность функций относительно групп преобразований.}

\subsection{Группы инерции}

\opr Подстановкой непустого множества $M$ называют любое биективное отображение $M$ на себя.
При известном n будем обозначать: $f(x_1; \ldots, x_n)=f(\vec{x})$.

\opr Пусть $f(\vec{x})$ и $h(\vec{x})$ - функции из $F_k(n)$ и $G$ - произвольная группа подстановок множества $\Omega_k^n$.
Говорят, что $f$ эквивалентно $h$ относительно группы $G$, если существует подстановка $g \in G \mid \forall \vec{\alpha} \in \Omega_k^n$ выполняется:
$$
f(\vec{\alpha})=h(g(\vec{\alpha})).
$$
Обозначение : $f \stackrel{G}{\sim} h$.
 
\utv
\begin{enumerate}
  \item $f \stackrel{G}{\sim} f$
  \item $f \stackrel{G}{\sim} h \Leftrightarrow h \stackrel{G}{\sim} f$
  \item $f \stackrel{G}{\sim} h, \  h \stackrel{G}{\sim} r \Rightarrow f \stackrel{G}{\sim} r$
\end{enumerate}

$\stackrel{G}{\sim}$ - отношение эквивалентности.

Таким образом $F_k(n)$ разбивается на классы эквивалентности. Класс, содержащий функию $f$, будем называть $[f]_G$.
Очевидно $1 \leq |[f]_G|\leq|G|$.

\opr Функция $f(\vec{x}) \in F_k(n) $ - называется инвариантной относительно подстановки $g \in G < S_{\Omega_k^n}$,
если $f(g(\vec{x})) = f(\vec{x})$, относительно группы $G$, если она инвариантна относительно любой подстановки из этой группы.

\utv Множество подстановок $g \in G$, относительно которых функция $f$ инвариантна образует подгруппу в группе $G$.

\opr Подгруппа, определенная в утверждении, несёт название - Группа инерции - функции $f$ в группе $G$. Обозначение: $I_G(f)$.

\thr Если $f\in F_k(n)$ и $G < S_{\Omega^k}$, то $|[f]_G|=\frac{|G|}{|I_G(f)|}$

\opr Орбитой группы подстановок $G < S_{\Omega^k}$, содержащей элемент $\alpha$, называется множество
$$
\bigtriangleup_\alpha = \{ \beta \in \Omega_k^n\: |\:  \exists g\in G \mid \beta =g(\alpha)\}.
$$

\utv $f$ инвариантна относительно группы $G \Leftrightarrow$ на элементах каждоой орбиты она принимает постоянные значения.
То есть $\forall p \in \bigtriangleup_{\alpha} \mid f(\beta) = f(\alpha)$.

\conseq $G$- транзитивна $\Leftrightarrow f$ инвариантна $\Leftrightarrow f \equiv$ const.

\conseq Число функций $k$ - значной логики инвариантно относительно группы $G$ равно $k^{\nu(G)}$, где $\nu(G)$ - число орбит группы $G$.

\examplei
\begin{enumerate}
  \item Группа подстановок координат векторов $\alpha \in \Omega_k^n$:
    \begin{align*}
      g_s(a_1, \dots , a_n)  =  a_{i_1};\dots ;a_{i_n} \text{в соответсвии с перестановкой}\  
      g_s=
      \begin{pmatrix}
        1 & \ldots & n \\
        i_1 & \ldots & i_n
      \end{pmatrix}
  \end{align*}
  Обозначение: $S_n$.

  \item Группа сдвигов: $\Sigma_n $. Пусть $\alpha = (a_1;\dots;a_n) \in \Omega_k^n $, тогда
    $$
      \Sigma_n = \{g_\alpha \mid g_\alpha(c_1; \ldots; c_n)=(c_1+a_1; \ldots; c_n+a_n); \alpha, \vec{c} \in \Omega_k^n\}
    $$
  Суммирование ведется по модулю $k$.

  \item Группа Джевонса $Q_n$:
    $$
      Q_n = <\Sigma_n;S_n>.
    $$
  \item $GL(n;k)$ - полная линейная группа. Пусть $A$ - невырожденная матрица размеров $n \times n $ над $\Z_k$, тогда
  $$
    GL(n;k)=\{q_A \mid q_A(a_1;\ldots;a_n) = (a_1;\ldots;a_n) \cdot A; A \in (\Z_k)_{n \times n}^* \}
  $$

  \item Полная афинная группа $AGL(n;k)=<GL(n;k);\Sigma_n>$.
\end{enumerate}

Диаграмма вложения группы:
\begin{align*}
  \xymatrix{
    S_n      \ar[r] \ar[rdd]  & GL(n; k) \ar[rd] \\
    & & AGL(n;k) \\
    \Sigma_n \ar[r]  & Q_n \ar[ru]
  }
\end{align*}

$\Sigma_n; Q_n; AGL(n;k) $ - транзитивные $\Rightarrow$ инвариантны относительно них только константы.

Орбитами группы $S_n$ являются множества векторов одинакового веса. Число функций одинакового веса инвариантных относительно$ S_n$ ровно $k^{k+n-1 \choose k-1}$.

\thr Орбитами группы $GL(n;k)$ являются все множества $M_\alpha=\{(a_1;\dots;a_n)\in \Omega_k^n|\mathrm{\text{НОД}}(a_1;\dots;a_n;k)=d\}, \text{где}\   d|k$.
                   
\conseq Число функций $n$ - значной логики (от $n$-переменных), инвариантных относительно $GL(n;k)$ равно $k^{\nu(k)}$,где $\nu(k)$ - число делителей $k$.

\thr
Пусть $T_k(n)$-множество всех функций $k$-значной логики с тривиальной группой инерции в $AGL(n;k)$. Тогда $$\lim_{n\to\infty} \frac{|T_n(k)|}{|F_k(n)|}=1$$.

\proof
1)Оценим сверху число неподвижных точек нетождественного aфинного преобразования $g \in AGL(n;k)$.  Рассмотрим уравнение $g(\vec{x})=\vec{x}A+\alpha;\alpha \in Z_k^n;$ $A$-невырожденная матрица над $Z_k;$ В матричном виде уравнение перепишется следующим образом:\\
$\vec{x}(E-A)=\alpha. $\\
Если $A=E$ ,то $\nexists$ решений, так как $\vec{\alpha}\neq \vec{0}$ ($g$ - нетождественное преобразование). Пусть $ C=(C_{ij})_{n \times n} = E-A \neq 0 $.\\

Не ограниченная общность $c_{11} \neq 0 $ , тогда $ c_{11} x_1 + \ldots + c_{n1} x_n = a_1 $ -слогаемые системы, если зафиксировать $x_2;\dots;x_n $ произвольными значениями из $Z_k $, то полученное уравнение будет иметь не более $НОД(C_n;k) $ решений, а так как $C_{11} \neq 0$, то число решений при произвольной фиксации $x_2;\dots;x_n \leqslant \frac{k}{2} \rightarrow $ для всего уравнения имеем $ (\frac {k}{2})^n$. ( то есть число решений $\vec{x}(E-A) = \alpha $, не превосходит $(\frac {k}{2})^n \leqslant \frac {k^n}{2} $.)\\
2)Поскольку количество точек (неподвижных) афинной подстановки ( $ k^{l(g)} $, где $l(g)$-число циклов ) не превосзодят $\frac {k^n}{2} $, то количество независимых циклов в её разложении может превосходить $\frac {3k^n}{4} $. ( $\frac {k^n}{2} $ - циклов длины 1; $\frac {k^n}{4} $ - циклов длины 2)\\
$\rightarrow $ количество функций инвариантных относительно фиксированных подстановок $g$ не провосходят $k^{\frac{3k^n}{4}}$, так как функция должна принимать одинаковые значения на элементах каждой орбиты. \\
3) $$|AGL(n;k)| \leqslant k^{n^2+n} \rightarrow k^{\frac{3k^n}{4} +n^2 +n} \rightarrow \lim_{n\to\infty} \frac{|T_n(k)|}{|F_k(n)|} = \frac {k^{k^n}-k^{\frac {3k^n}{n}+n^2+n}}{k^{k^n}}=1$$\\

Классы эквивалентности по $\stackrel{G}{\sim}$ назовем $G$-типом. Для осуществления полной классификации необходимо построить список представителей $G$ типов.
$f^{(1)};\dots; f^{l(G)}; l(g)$- число $G$-типов.
Строится последовательность $f_1;f_2;\dots $. Среди них могу быть одинаковые представители из какого-то класса. Полагаем $ f^{(1)}=f_1$ и считаем:\\ 
$|I_G(f^{(1)})|$, проверяем $f_2 \in I_G(f^{(2)})$; если нет, то считаем:\\
$|I_G(f^{(2)})|, при f^{(2)} =f_2$ и так далее $\dots$\\
Останавливаемся, когда :\\
$$ \sum_{i=1}^{l} \frac{|G|}{|I_G(f^{(2)})|} = k^{k^n} $$\\ то есть необходимость вычисления порядка групп инерции. Значение параметра $l(G)$ упрощает метод. Задача поиска этого параметра носит название задачи перечисления $G$ - типов.\\

\subsection{Инварианты, нахождение групп инерции и проверка экваивалентности.}

\opr 
Отображение $\varphi$ - называется инвариантом группы $G$, если для любого $g \in G$ и произвольной $m \in M$ справедливо равенство:\\
$\varphi(g(m))=\varphi(m)$.\\
Инвариант $\varphi$ называется полным, если из $\varphi (m_1) = \varphi(m_2) \rightarrow $ что элементы $m_1 $ и $m_2$ лежат на одной орбите группы $G$. Принимая во внимание факт, что для $G$, действующей на $F_k(n)$, орбита будет являться $G$ - типом, сформируем правило проверки эквивалентности $f_1 $ и $f_2 \in F_k(n)$.\\
Пусть $\varphi$ - инвариант группы $G$, действующей на $F_k(n)$, если $\varphi$ -полный, то $\varphi(f_1)=\varphi(f_2) $ равносильно тому, что $f_1 \stackrel{G}{\sim} f_2$;\\
Если $\varphi$ неполный инвариант, то $\varphi(f_1)=\varphi(f_2) $ - только необходимое условие эквивалентности.
В случае, когда равенство выполнено, надо проверять другие инваринты:\\

$\sqsupset k = ?$\\
\begin{enumerate}
	\item Для $AGL(n;k); S_n; \sum_n; Q_n $ инварианты - вес, степени нелинейности.
	\item $Q_n$ - число простых импликант, число существенных переменных.
	\item $S_n$ - число одночленов в многочлене Жегалкина.\\
\end{enumerate}

\example 
Пусть $f(x_1;x_2;x_3) = x_1\oplus x_2$\\
$f_2(x_1;x_2;x_3)=x_1 \oplus x_2 \oplus x_3$ \\
Они не эквивалентны относительно $S_n;Q_n$, но
$f_2(x_1;x_2;x_3)=f_1((x_1;x_2;x_3)A)$\\



$A=
\begin{pmatrix}
  1 & 0 & 0\\
  0 & 1 & 0\\
  1 & 0 & 1
\end{pmatrix}$\\

$x_1 \oplus x_2;x_1;x_3$.\\

\thr
Для любого натурального $ m \geqslant 2$ и произвольной группы $G$:
$|G|=m, \exists n\  \text{и}\  f\in F_2(n) \mid I_{S_n}(f) \cong G$.